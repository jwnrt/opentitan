# Copyright lowRISC contributors (OpenTitan project).
# Licensed under the Apache License, Version 2.0, see LICENSE for details.
# SPDX-License-Identifier: Apache-2.0

load("@rules_rust//rust:defs.bzl", "rust_library")
load("//rules/opentitan:defs.bzl", "OPENTITAN_CPU")

rust_library(
    name = "opensk",
    srcs = [
        "src/test_helpers/mod.rs",
        "src/api/clock.rs",
        "src/api/attestation_store.rs",
        "src/api/crypto/rust_crypto.rs",
        "src/api/crypto/sha256.rs",
        "src/api/crypto/hmac256.rs",
        "src/api/crypto/ecdsa.rs",
        "src/api/crypto/mod.rs",
        "src/api/crypto/aes256.rs",
        "src/api/crypto/ecdh.rs",
        "src/api/crypto/hkdf256.rs",
        "src/api/crypto/software_crypto.rs",
        "src/api/connection.rs",
        "src/api/rng.rs",
        "src/api/key_store.rs",
        "src/api/mod.rs",
        "src/api/customization.rs",
        "src/api/private_key.rs",
        "src/api/firmware_protection.rs",
        "src/api/user_presence.rs",
        "src/env/test/mod.rs",
        "src/env/test/customization.rs",
        "src/env/mod.rs",
        "src/lib.rs",
        "src/ctap/command.rs",
        "src/ctap/response.rs",
        "src/ctap/data_formats.rs",
        "src/ctap/storage/key.rs",
        "src/ctap/ctap1.rs",
        "src/ctap/apdu.rs",
        "src/ctap/token_state.rs",
        "src/ctap/client_pin.rs",
        "src/ctap/large_blobs.rs",
        "src/ctap/credential_management.rs",
        "src/ctap/u2f_up.rs",
        "src/ctap/pin_protocol.rs",
        "src/ctap/status_code.rs",
        "src/ctap/storage.rs",
        "src/ctap/secret.rs",
        "src/ctap/config_command.rs",
        "src/ctap/mod.rs",
        "src/ctap/main_hid.rs",
        "src/ctap/hid/receive.rs",
        "src/ctap/hid/send.rs",
        "src/ctap/hid/mod.rs",
        "src/ctap/vendor_hid.rs",
        "src/ctap/crypto_wrapper.rs",
    ],
    deps = [
        "//sw/device/silicon_owner/tock/tests/ctap/cbor",
        "//sw/device/silicon_owner/tock/tests/ctap/crypto",
        "//sw/device/silicon_owner/tock/tests/ctap/persistent_store",
        "@crate_index//:byteorder",
        "@crate_index//:arrayref",
        "@crate_index//:subtle",
        "@crate_index//:rand_core",
        "@crate_index//:zeroize",
    ],
    aliases = {
        "//sw/device/silicon_owner/tock/tests/ctap/cbor": "sk-cbor",
    },
    target_compatible_with = [OPENTITAN_CPU],
)

